<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Broom - sweep the room!</title>
  <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css" />
  <link rel="icon" href="favicon.svg" type="image/svg-xml">
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Raleway:wght@800&display=swap");

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      --font-family: "Raleway", sans-serif;
      --font-weight: 800;
    }
  </style>
</head>

<body>
  <main class="container">

    <hgroup>
      <h1><svg width="50%" viewBox="0 0 2075 496" version="1.1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink">
          <path
            d="M201.274423,232.466337 C186.463498,209.615875 169.53047,198.232248 150.475337,198.315456 L80.5200924,17 L175.2,17 C216.800208,17 248.399892,26.9910584 270,46.9734748 C291.600108,66.9558912 302.4,95.7301393 302.4,133.297082 C302.4,156.077037 298.300041,174.960137 290.1,189.94695 C281.899959,204.933762 269.400084,217.622406 252.6,228.013263 C269.400084,231.210449 283.699941,236.106068 295.5,242.700265 C307.300059,249.294463 316.899963,257.38722 324.3,266.97878 C331.700037,276.57034 336.999984,287.360683 340.2,299.350133 C343.400016,311.339582 345,324.128137 345,337.71618 C345,358.897542 341.300037,377.680732 333.9,394.066313 C326.499963,410.451894 316.100067,424.239555 302.7,435.429708 C289.299933,446.619861 273.000096,455.01235 253.8,460.607427 C234.599904,466.202504 213.00012,469 189,469 L0,469 L0,17 L54.9554158,17 L122.19887,206.937219 C110.758281,215.460649 108.232178,229.628487 114.620562,249.440733 C121.33725,248.563401 128.057609,247.610178 134.633919,246.590555 C160.411591,242.593861 183.068178,237.833205 201.274427,232.466335 L201.274423,232.466337 Z M209.910181,240.278508 C190.193371,246.567577 165.112949,251.975683 136.167385,256.463543 C130.069937,257.40892 123.851614,258.297911 117.6249,259.12315 C124.927442,290.033216 119.212668,319.618821 100.480578,347.879962 C71.0965218,392.211746 34.2693292,432.386243 32.6296553,433.776463 C55.1032318,434.692049 79.7316343,428.387717 106.514863,414.863467 C106.514863,422.895061 99.8295656,430.023061 86.458971,436.247467 C103.969985,437.834879 131.75653,429.131944 169.818604,410.138663 C160.89255,420.713939 151.420751,429.416873 141.403205,436.247467 C154.783938,436.247467 178.332412,425.847592 212.048627,405.047842 C206.731301,415.055727 201.758649,423.3153 197.130673,429.826563 C229.870753,420.323746 251.839148,403.819218 263.035857,380.312978 C286.794903,330.433515 269.086344,283.755358 209.910181,240.278508 L209.910181,240.278508 Z"
            id="Shape" fill="currentcolor"></path>
          <text id="room" font-family="Futura-Bold, Futura" font-size="600" font-weight="bold" fill="currentcolor">
            <tspan x="391.9" y="467">room</tspan>
          </text>

        </svg>
      </h1>
      <h2>Browser-based room impulse response measurement.</h2>
    </hgroup>
    <p>
      This tool let's you measure room impulse responses using a sine-sweep and export it as a wav file.
    </p>

    <div class="grid">
      <!-- Setup Audio--->
      <article>
        <hgroup>
          <h2>Audio Settings</h2>
          <h2>Configure input device.</h2>
        </hgroup>

        <label for="inputDevices">Input Device
          <select id="inputDevices" required>
            <option value="" selected disabled>Select input device</option>
          </select>
        </label>
        <progress id="inputLevelMeter" value="0" max="100"></progress>
        <div class="grid">
          <button role="button" class="outline" id="refreshDevices">Refresh list</button>
        </div>
      </article>

      <!-- Sweep Settings-->
      <article>
        <hgroup>
          <h2>Sweep Settings</h2>
          <h2>Adjust the sweep settings and generate the excitation signal.</h2>
        </hgroup>

        <label for="sweepLength">Duration: <b><span id="sweepLengthValue">5</span>s</b>
          <input type="range" min="1" max="15" value="3" id="sweepLength" name="sweepLength">
        </label>
        <label for="sweepStartFrequency">Start Frequency: <b><span id="sweepStartFrequencyValue">20</span>Hz</b>
          <input type="range" min="10" max="50" value="20" id="sweepStartFrequency" name="sweepStartFrequency">
        </label>
      </article>
    </div>

    <!-- Measurement-->
    <article>
      <hgroup>
        <h2>Measurement</h2>
        <h2>Start and stop measurement.</h2>
      </hgroup>

      <div class="grid">
        <label for="recordDelay">
          Record delay in s <em
            data-tooltip="Delay between clicking the record button and actual start of recording">(?)</em>
          <input type="text" id="recordDelay" value="1" required>
        </label>

        <label for="irLength">
          Impulse response length in s <em data-tooltip="Length of cut IR in s">(?)</em>
          <input type="text" id="irLength" value="2" required>
        </label>


        <label for="fadeInTime">
          Fade-in time in ms <em data-tooltip="Onset cut of IR (experimental)">(?)</em>
          <input type="text" id="fadeInTime" value="50" required>
        </label>
      </div>

      <progress id="measurementProgress" hidden></progress>
      <div class="grid">
        <button id="start">Start measurement</button>
      </div>

      <p>
      <div id="gd" style="width: 100%; height: 300px"></div>
      </p>
      <div class="grid">
        <button id="downloadButton" class="outline" role="button">Download Impulse
          Response</button>
      </div>
    </article>



  </main>

  <footer class="container">
    <small>
      Made by <a href="https://danielrudrich.de/" class="secondary">Daniel Rudrich</a>
      • <a href="https://github.com/danielrudrich/broom/">Source Code</a>
      • Built with awesome <a href="https://picocss.com">Pico CSS</a>
    </small>
  </footer>


  <script src="main.js"></script>
</body>

</html>
