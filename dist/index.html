<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Broom - sweep the room!</title>
  <meta name="description" content="Browser-based room impulse response measurement.">
  <meta property="og:url" content="https://danielrudrich.github.io/Broom/">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Broom - sweep the room!">
  <meta property="og:description" content="Browser-based room impulse response measurement.">
  <meta property="og:image" content="https://danielrudrich.github.io/Broom/broom.png" />
  <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css" />
  <link rel="icon" href="favicon.svg" type="image/svg-xml">
  <link color="#FFFFFF" rel="mask-icon" href="favicon.svg" type="image/svg-xml">
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Raleway:wght@800&display=swap");

    body>header,
    body>main,
    body>footer,
    section {
      --block-spacing-vertical: calc(var(--spacing) * 1.5);
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      --font-family: "Raleway", sans-serif;
      --font-weight: 800;
    }
  </style>
</head>

<body>
  <nav class="container-fluid">
    <ul></ul>
    <ul>
      <li>
        <a href="https://github.com/danielrudrich/broom/" class="secondary" aria-label="Broom Github Repository">
          View on GitHub <svg aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 496 512" height="30px">
            <path fill="currentColor"
              d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z">
            </path>
          </svg>
        </a>
      </li>
    </ul>
  </nav>
  <main class="container">
    <hgroup>
      <h1><svg width="50%" viewBox="0 0 2075 496" version="1.1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink">
          <path
            d="M201.274423,232.466337 C186.463498,209.615875 169.53047,198.232248 150.475337,198.315456 L80.5200924,17 L175.2,17 C216.800208,17 248.399892,26.9910584 270,46.9734748 C291.600108,66.9558912 302.4,95.7301393 302.4,133.297082 C302.4,156.077037 298.300041,174.960137 290.1,189.94695 C281.899959,204.933762 269.400084,217.622406 252.6,228.013263 C269.400084,231.210449 283.699941,236.106068 295.5,242.700265 C307.300059,249.294463 316.899963,257.38722 324.3,266.97878 C331.700037,276.57034 336.999984,287.360683 340.2,299.350133 C343.400016,311.339582 345,324.128137 345,337.71618 C345,358.897542 341.300037,377.680732 333.9,394.066313 C326.499963,410.451894 316.100067,424.239555 302.7,435.429708 C289.299933,446.619861 273.000096,455.01235 253.8,460.607427 C234.599904,466.202504 213.00012,469 189,469 L0,469 L0,17 L54.9554158,17 L122.19887,206.937219 C110.758281,215.460649 108.232178,229.628487 114.620562,249.440733 C121.33725,248.563401 128.057609,247.610178 134.633919,246.590555 C160.411591,242.593861 183.068178,237.833205 201.274427,232.466335 L201.274423,232.466337 Z M209.910181,240.278508 C190.193371,246.567577 165.112949,251.975683 136.167385,256.463543 C130.069937,257.40892 123.851614,258.297911 117.6249,259.12315 C124.927442,290.033216 119.212668,319.618821 100.480578,347.879962 C71.0965218,392.211746 34.2693292,432.386243 32.6296553,433.776463 C55.1032318,434.692049 79.7316343,428.387717 106.514863,414.863467 C106.514863,422.895061 99.8295656,430.023061 86.458971,436.247467 C103.969985,437.834879 131.75653,429.131944 169.818604,410.138663 C160.89255,420.713939 151.420751,429.416873 141.403205,436.247467 C154.783938,436.247467 178.332412,425.847592 212.048627,405.047842 C206.731301,415.055727 201.758649,423.3153 197.130673,429.826563 C229.870753,420.323746 251.839148,403.819218 263.035857,380.312978 C286.794903,330.433515 269.086344,283.755358 209.910181,240.278508 L209.910181,240.278508 Z"
            id="Shape" fill="currentcolor"></path>
          <text id="room" font-family="Futura-Bold, Futura" font-size="600" font-weight="bold" fill="currentcolor">
            <tspan x="391.9" y="467">room</tspan>
          </text>

        </svg>
      </h1>
      <h2>Browser-based room impulse response measurement.</h2>
    </hgroup>
    <p>
      <a class="github-button" href="https://github.com/danielrudrich/broom"
        data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="octicon-star" data-size="large"
        data-show-count="true" aria-label="Star danielrudrich/broom on GitHub">Star</a>
    </p>

    <article>
      <hgroup>
        <h2>Sweep the room</h2>
        <h2>What it's all about.</h2>
      </hgroup>
      <p>Use the power of the <strong>Web Audio API</strong> to capture <strong>Room Impulse Responses</strong>... in
        the browser! This web app uses a sine sweep to excite the room. The microphone captures the response of the room
        you want to measure. This <strong>Sweep Response</strong> is then processed to an </i>Impulse Response</i>,
        ready for you to download.</p>
      <p><small><strong>Please note</strong>: this project is in its very early stage and is still work in progress. So
          there might be some bugs and the results may even differ between browsers.</p></small>
    </article>

    <div class="grid">
      <!-- Setup Audio--->
      <article>
        <hgroup>
          <h2>Audio Settings</h2>
          <h2>Configure the input device.</h2>
        </hgroup>

        <label for="inputDevices">Input Device
          <select id="inputDevices" required>
            <option value="" selected disabled>Select input device</option>
          </select>
        </label>
        <progress id="inputLevelMeter" value="0" max="100"></progress>
        <div class="grid">
          <button role="button" class="outline" id="refreshDevices">Refresh list</button>
        </div>
        <code id="sampleRateInfo"></code>
      </article>

      <!-- Sweep Settings-->
      <article>
        <hgroup>
          <h2>Sweep Settings</h2>
          <h2>Adjust the excitation signal.</h2>
        </hgroup>

        <label for="sweepLength">Duration: <b><span id="sweepLengthValue">5</span>s</b>
          <input type="range" min="1" max="15" value="3" id="sweepLength" name="sweepLength">
        </label>
        <label for="sweepStartFrequency">Start Frequency: <b><span id="sweepStartFrequencyValue">20</span>Hz</b>
          <input type="range" min="10" max="50" value="20" id="sweepStartFrequency" name="sweepStartFrequency">
        </label>
      </article>
    </div>

    <!-- Measurement-->
    <article>
      <hgroup>
        <h2>Measurement</h2>
        <h2>Start the measurement.</h2>
      </hgroup>
      </div>

      <div class="grid">
        <label for="recordDelay">
          Record delay in s <em
            data-tooltip="Delay between clicking the record button and actual start of recording">(?)</em>
          <input type="number" id="recordDelay" value="1" required>
        </label>

        <label for="irLength">
          Impulse response length in s <em data-tooltip="Length of cut IR in s">(?)</em>
          <input type="number" id="irLength" value="2" required>
        </label>
        <label for="measurementLevelMeter">Input level
          <progress id="measurementLevelMeter" value="0" max="100"></progress>
        </label>
      </div>
      <progress id="measurementProgress" hidden></progress>
      <button id="start">Start measurement</button>
    </article>

    <article>
      <hgroup>
        <h2>Impulse Response</h2>
        <h2>Visualize and adjust the impulse response.</h2>
      </hgroup>

      <p>
      <div id="gd" style="width: 100%; height: 300px"></div>
      </p>

      <div class="grid">
        <small><strong>Zoom-in</strong>: select an area. <strong>Zoom-out</strong>: double-click.</small>
        <fieldset>
          <small><label for="decibelsSwitch">
              <input type="checkbox" id="decibelsSwitch" role="switch">
              Show decibels
            </label></small>
        </fieldset>
      </div>

      <p>
        <a href="#" role="button" id="normalizeButton" class="outline">Normalize</a>
        <a href="#" role="button" id="cutToSelectionButton" class="outline">Cut to time selection</a>
        <a href="#" role="button" id="resetButton" class="outline secondary">Reset to original</a>
      </p>
      <details>
        <summary>Fade-in / Fade-out</summary>
        <p><small>Time are in milliseconds!</small></p>
        <div class="grid">
          <input type="number" id="fadeInTime" value="50" required>
          <button role="button" id="fadeInButton" class="outline">Apply fade-in</button>
          <input type="number" id="fadeOutTime" value="500" required>
          <button role="button" id="fadeOutButton" class="outline">Apply fade-out</button>
        </div>
      </details>
    </article>



    <article>
      <hgroup>
        <h2>Export</h2>
        <h2>Download the IR as a Wav file.</h2>
      </hgroup>

      <button id="downloadButton" class="outline" role="button">Download Impulse
        Response</button>

    </article>

  </main>

  <footer class="container">
    <small>
      Made by <a href="https://danielrudrich.de/" class="secondary">Daniel Rudrich</a>
      • <a href="https://github.com/danielrudrich/broom/">Source Code</a>
      • Built with awesome <a href="https://picocss.com">Pico CSS</a>
    </small>
  </footer>


  <script src="main.js"></script>
</body>

</html>
